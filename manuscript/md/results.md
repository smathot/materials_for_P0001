## Definition of preparatory responses

Due to neural-processing delays, even when response preparation starts before saccade execution, the overt response may occur during or after. Therefore, we need a criterion to unambiguously attribute pupillary responses to pre-saccadic preparation, even if these responses occur during or after the saccade. More specifically, we need to know the first moment at which the pupil could, in theory, respond to events that occurred at the time of the saccade. This is particularly important in our experiment, because our conditions differed in the display change that occurred during the saccade, and this may affect pupil size [e.g., @BarburHarlowSahraie1992]. A lower bound for the pupillary response latency is 220 ms [@Ellis1981]. [Visual change generally induces a much slower response, cf. @Gamlin1998]. In sum, we consider the first 220 ms after the display change as reflecting preparatory activity.

## Pupil-trace analysis, off-line saccade detection, and exclusion criteria

Each trial was divided into three epochs: the baseline epoch, spanning the 100 ms prior to the presentation of the auditory cue; the pre-saccade epoch, from the cue until the detection of the saccade; and the post-saccade epoch, from the detection of the saccade until the end of the trial, or until another saccade was made (i.e. when participants broke fixation before the end of the trial). We analyzed pupil surface relative to the mean pupil size during the baseline epoch [cf. @Mathôt2013Plos]. Missing data during blinks was reconstructed, where possible, using cubic-spline interpolation [@Math2013Blinks]. No signal smoothing was applied.

For the analysis, we used the EyeLink saccade-detection algorithm (velocity threshold: 35 °/s; acceleration threshold: 9500 °/s^2^), and considered the first saccade that was larger than 1.8°. Saccades were executed on average 543.6 ms (SD = 187.4) after the auditory cue. Off-line verification of timing, based on a trigger that was sent to the eye tracker immediately after the display change, showed that the display change occurred  27.09 ms (SD = 3.906) after saccade onset and 27.55 ms (SD = 7.852) before saccade offset. In other words, the display change fully occurred during the saccade, even allowing for the monitor's phosphor persistence [< 10 ms, @WangNikolic2011] and refresh cycle.

Trials were excluded when saccades were executed before the cue or in the wrong direction (8.4%), when saccade latency was less than 50 ms or more than 2000 ms (0.5%), when the display change did not occur during the saccade (4.9%; per off-line verification), or when blinks occurred and could not be reconstructed (4.5%). 2350 trials (81.4%) remained for further analysis. There were no notable condition differences in saccade size (Constant: 9.74°, Onset: 9.51°, Swap: 9.70°), proportion of discarded trials (Constant: 18.5%, Onset: 17.8%, Swap: 18.9%), or fixation stability during the post-saccade epoch (mean standard deviation of horizontal gaze position; Constant: 0.28°, Onset: 0.35°, Swap: 0.31°).

## The effect of eye-movement preparation on the PLR

In addition to luminance, pupil size depends on numerous factors, such as arousal [@Loewenfeld1958], visual change [@BarburHarlowSahraie1992], novelty [@Naber2013Novelty], and motor preparation [@Jainta2011Motor]. Pupil-size measurements can also be distorted by eye-tracker artifacts, such as camera viewing angle [@Choe2014]. It is clear that such factors play a role in our data as well (%FigMain::b,c,d). For example, there is a late overall constriction in the Swap and Onset conditions, which is presumably triggered by the display change [@BarburHarlowSahraie1992]. In addition, there is a gradual dilation throughout the trial, which presumably reflects steadily increasing arousal. In other words, the overall pupil signal is determined by a complex mixture of factors [for a recent review, see @Laeng2012Window].

However, here we focus on the effect of luminance (i.e. the PLR) within conditions. The PLR is a relative constriction on Land-on-Bright trials and shown as a negativity in %FigMain::a.

%--
figure:
 id: FigMain
 source: FigMain.svg
 caption: >
  a) Mean difference in pupil size between Land-on-Bright and Land-on-Dark trials for the three conditions as a function of time relative to display change. The PLR is shown as a negativity. The dot-dashed line shows the 'flipped' Swap condition, and is shown for comparison with the Constant condition. b, c, d) Mean pupil size on Land-on-Dark and Land-on-Bright trials over time for the Constant (b), Swap (c), and Onset (d) conditions. The PLR is shown as a decreased pupil size on Land-on-Bright trials, relative to Land-on-Dark trials. Line widths indicate mean ± standard error. Background shadings indicate significant divergence between Land-on-Dark and Land-on-Bright trials (t > 2 for at least 200 consecutive samples). a, b, c, d) The vertical dotted lines correspond to mean saccade onset (left-most) and offset (right-most). The surrounding shadings indicate the full range of observed values. The display change (or a dummy change in the Constant condition) occurred at time 0, indicated by the dashed vertical line.
--%

To determine the earliest effects of luminance on pupil size, we conducted linear mixed-effects (LME) analyses with Participant as random effect, Target Luminance (post-saccadic; Land-on-Dark or Land-on-Bright) as fixed effect, and Pupil Size as dependent measure. This analysis was performed separately for each time point and condition. We considered divergence between Land-on-Dark and Land-on-Bright trials to be significant when t > 2 [cf. @Baayen2008Mixed] for at least 200 consecutive samples [cf. @Mathôt2013Plos].

Eye-movement preparation affected the PLR in two main ways. Firstly, in the Constant condition, divergence occurred already during the saccade, before the eyes had landed (Constant: from -9 ms until trial end; Values relative to display change at time 0). This extremely rapid modulation of pupil size clearly shows that a PLR was prepared before saccade onset. As expected, divergence was observed much later in the Onset condition (+283 ms until trial end), in which preparation was not possible.

Secondly, in the Swap condition there was initially a (seemingly) inverse PLR, again arising during the saccade (-3 ms until +417 ms). Strikingly, the (flipped) Swap condition was indistinguishable from the Constant condition until about 250 ms after the saccade (compare the dot-dashed and solid lines in %FigMain::a). This suggests that it takes about 250 ms for the pupil to respond to the post-saccadic luminance, consistent with previous estimates of the PLR latency [e.g., @Ellis1981;@WangMunoz2014]. From about 600 ms onwards the Swap condition was indistinguishable from the Onset condition (compare the dashed and dotted lines in %FigMain::a), suggesting that by this time the preparatory component of the PLR had fully dissipated.

## Modeling the PLR

A visual inspection of %FigMain::a suggests that preparation qualitatively alters the shape of the PLR, rather than merely reduces its latency. More specifically, in the Constant condition, the PLR appeared to consist of a small, but rapidly developing bias, followed later by a larger response, which we call the 'full PLR'. Through modeling, we can investigate whether the effect of preparation is limited to this initial bias, or whether the latency of the full PLR is reduced as well. In addition, modeling allows us to ascertain that the differences found with LME were not due to differences in noise level.

As a first step, we modeled only the 0 - 220 ms interval, which we had defined as reflecting purely preparatory activity (%FigFit::a). For each participant separately, we fitted a linear function to the mean difference response in the three conditions. To allow for direct comparison with the Constant condition, we 'flipped' the Swap condition. Next, we used paired-samples *t* tests to test for differences in slope and intercept, using a Bonferroni-corrected alpha level of .0083 (= .05 / 6 comparisons). This showed that the slope was significantly lower (i.e. more negative) in the Constant (t(7) = 5.19, p = .0013) and Swap (t(7) = 3.87, p = .0061) conditions than in the Onset condition, whereas there was no difference between the Constant and Swap conditions (t(7) = 1.23, p = .2581). The comparisons for the intercept showed the same qualitative pattern, but were less reliable (Constant vs Onset: t(7) = 2.69, p = .0310; Swap vs Onset: t(7) = 1.66, p = .1396; Constant vs Swap: t(7) = 0.34, p = .7460). In sum, a linear model of the 0 - 220 ms interval revealed a rapidly developing PLR if, and only if, preparation was possible.

%--
figure:
 id: FigFit
 source: FigFit.svg
 caption: |
  a) The difference in pupil size between Land-on-Bright and Land-on-Dark trials over time in the 0 - 220 ms interval. Solid, dashed, and dashed-dotted lines indicate the observed grand mean response. Dotted lines indicate linear-model fits. b) The exponential-decay function used to model pupil-size difference (`p(t)`) as a function of time since display change (`t`). This function has four free parameters: full PLR latency (`t0`), initial pupil-size difference (`p1`), final pupil-size difference (`p2`), and response speed (the inverse of `s`). c) Observed difference in pupil size between Land-on-Bright and Land-on-Dark trials and model fits (dotted lines) for the Constant and Onset conditions (solid and dashed lines, respectively). Vertical lines indicate full PLR latencies (`t0`) for the Constant (solid) and Onset (dashed) conditions. The left pane depicts the grand mean response. The eight rightward panes show the mean responses for each of the eight participants.
--%

Next, we modeled a longer (0 - 2000 ms) interval. We emphasize that not all effects observed in this interval necessarily reflect preparatory activity, but we nevertheless felt that modeling a longer interval is informative. We chose an exponential-decay function, adapted from @HoeksLevelt1993, which models the difference in pupil size between Land-on-Bright and Land-on-Dark trials (`p(t)`) as a function of time since display change (`t`; see %FigFit::b). There are several other functions that fit the PLR about equally well, but the advantage of exponential decay is that its parameters have clear interpretations: full PLR latency (`t0`), initial pupil-size difference (`p1`), final pupil-size difference (`p2`), and response speed (the inverse of `s`). Because the Swap condition is a combination of two opposite responses (to the pre- and post-saccadic brightness of the target, see %FigMain::c), it is not properly modeled in a way that allows for direct comparison with the other conditions. Therefore, we model only the Constant and Onset conditions here.

We determined the model parameters for each participant, and tested for differences using a Bonferroni-corrected alpha level of .0125 (= .05 / 4 comparisons). Crucially, full PLR latency (`t0`) was 107 ms lower on Constant trials (M = 268, SE = 16.0) than on Onset trials (M = 375, SE = 16.6, t(7) = 9.33, p < 0.0001). In addition, initial pupil-size difference (`p1`) was slightly smaller (i.e. more negative) on Constant than on Onset trials (t(7) = 4.17, p = .0042), as was final pupil-size difference (t(7) = 3.56, p = .0093). Response speed was slightly higher (i.e. a lower `s`) in the Constant condition than in the Onset condition, but this difference was not reliable (t(7) = 2.295, p = .0554). In sum, the exponential-decay model confirms and extends the LME analyses by showing that preparation both induces an initial bias (`p1`) and reduces the latency of the PLR (`t0`).

## Accounting for gaze bias prior to saccade onset

When you attend to a stimulus without looking directly at it (i.e. covert attention), fixational eye movements tend to gravitate towards the attended stimulus [@Engbert2003]. Similarly, in our experiment, fixational eye movements could bring the eyes slightly closer to the saccade target already before the eyes set in motion. To control for this, we eliminated gaze bias with a pairwise-matching algorithm [cf. @Mathôt2013Plos]. First, we determined the average horizontal gaze bias towards the cued side during the pre-saccade epoch for every trial. Next, we created pairs of trials with an opposite, but approximately equal bias (i.e. the summed bias was less than 0.03°). All trials that could not be paired were discarded (17.45%). This left a subset of trial in which there was no horizontal gaze bias (mean gaze bias < .01°). The analyses described above where re-run on this subset of trials. By and large, this revealed identical results to the full analysis (not shown; figures included in on-line supplementary analyses). However, it is worth highlighting that divergence in the Constant condition was observed even earlier, well before the eyes set in motion (from -105 ms until trial end). Crucially, this illustrates that our results are not due to a gaze-position bias prior to the eye movement, and demonstrates the robustness of the results.
